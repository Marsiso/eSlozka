@using static Domain.Constants.Translations.MainLayout

@inherits PageLayoutComponentBase<MainLayoutViewModel>

@inject IStringLocalizer<App> Localizer

<MudThemeProvider IsDarkMode="true"/>
<MudDialogProvider/>
<MudSnackbarProvider/>

<PermissionAuthorizeView>
    <Authorized>
        <MudLayout>
            <MudAppBar Color="Color.Inherit">
                <MudIconButton Edge="Edge.Start" Icon="@Icons.Material.Rounded.ViewSidebar" Color="Color.Inherit" Variant="Variant.Filled" OnClick="@Model.ToggleSidebar"/>
                <MudIconButton Edge="Edge.Start" Icon="@Icons.Material.Rounded.Search" Color="Color.Inherit" Variant="Variant.Filled" Class="ml-2"/>
                <MudText Class="ml-8" Typo="Typo.h5" Color="Color.Inherit">
                    @Localizer[Appbar.Brand]
                </MudText>
                <MudSpacer/>
                <MudMenu Variant="Variant.Text" AnchorOrigin="Origin.BottomLeft" TransformOrigin="Origin.BottomLeft">
                    <ActivatorContent>
                        <MudAvatar Rounded="true" Variant="Variant.Text"/>
                    </ActivatorContent>
                    <ChildContent>
                        <MudMenuItem Disabled="true" Icon="@Icons.Material.Rounded.Person3" IconColor="Color.Inherit">
                            @Session?.GivenName @Session?.FamilyName
                        </MudMenuItem>
                        <MudMenuItem Disabled="true" Icon="@Icons.Material.Rounded.Email" IconColor="Color.Inherit" Class="mb-4">
                            @Session?.Email
                        </MudMenuItem>
                        <MudMenuItem Icon="@Icons.Material.Rounded.AccountBox" IconColor="Color.Inherit">@Localizer[Appbar.Drawer.Link.Account]</MudMenuItem>
                        <MudMenuItem Icon="@Icons.Material.Rounded.Settings" IconColor="Color.Inherit">@Localizer[Appbar.Drawer.Link.Settings]</MudMenuItem>
                        <MudMenuItem Icon="@Icons.Material.Rounded.Logout" IconColor="Color.Inherit" OnClick="@Logout">@Localizer[Appbar.Drawer.Link.Logout]</MudMenuItem>
                    </ChildContent>
                </MudMenu>
            </MudAppBar>
            <MudDrawer @bind-Open="@Model.SidebarVisible" ClipMode="DrawerClipMode.Always" DisableOverlay="true" Variant="DrawerVariant.Responsive">
                <MudStack Justify="Justify.SpaceBetween" Class="flex flex-grow-1">
                    <MudNavMenu Color="@Color.Inherit" Margin="Margin.Normal">
                        <MudNavLink Icon="@Icons.Material.Rounded.Folder" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.Files]</MudNavLink>
                        <MudNavLink Icon="@Icons.Material.Rounded.Link" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.SharedWithMe]</MudNavLink>
                        <MudNavLink Icon="@Icons.Material.Rounded.Bookmark" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.Bookmarks]</MudNavLink>
                        <MudNavLink Icon="@Icons.Material.Rounded.Delete" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.Deleted]</MudNavLink>
                        <MudDivider DividerType="DividerType.Middle"/>
                        <MudNavLink Icon="@Icons.Material.Rounded.Error" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.Notifications]</MudNavLink>
                        <MudDivider DividerType="DividerType.Middle"/>
                        <MudNavLink Icon="@Icons.Material.Rounded.ManageAccounts" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.ManageUsers]</MudNavLink>
                        <MudNavLink Icon="@Icons.Material.Rounded.Security" IconColor="Color.Inherit" Match="NavLinkMatch.All" OnClick="@(() => Model.Navigation.NavigateTo(Routes.Management.Roles))">@Localizer[Sidebar.Drawer.Link.ManageRoles]</MudNavLink>
                        <MudNavLink Icon="@Icons.Material.Rounded.AddToDrive" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.ManageRepository]</MudNavLink>
                        <MudNavLink Icon="@Icons.Material.Rounded.DashboardCustomize" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.ManageCodeLists]</MudNavLink>
                        <MudNavLink Icon="@Icons.Material.Rounded.AddTask" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.ManageTasks]</MudNavLink>
                        <MudNavLink Icon="@Icons.Material.Rounded.BarChart" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.ManageStatistics]</MudNavLink>
                        <MudNavLink Icon="@Icons.Material.Rounded.ManageHistory" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.History]</MudNavLink>
                        <MudNavLink Icon="@Icons.Material.Rounded.LogoDev" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.Logs]</MudNavLink>
                    </MudNavMenu>
                    <MudNavMenu Color="@Color.Inherit" Margin="Margin.Normal">
                        <MudDivider DividerType="DividerType.Middle"/>
                        <MudNavLink Icon="@Icons.Material.Rounded.AccountBox" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.Account]</MudNavLink>
                        <MudNavLink Icon="@Icons.Material.Rounded.Settings" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.Settings]</MudNavLink>
                        <MudNavLink Icon="@Icons.Material.Rounded.Info" IconColor="Color.Inherit" Match="NavLinkMatch.All">@Localizer[Sidebar.Drawer.Link.AboutApplication]</MudNavLink>
                        <MudNavLink Icon="@Icons.Material.Rounded.Logout" IconColor="Color.Inherit" Match="NavLinkMatch.All" OnClick="@Logout">@Localizer[Sidebar.Drawer.Link.Logout]</MudNavLink>
                    </MudNavMenu>
                </MudStack>
            </MudDrawer>
            <MudMainContent>
                <MudContainer MaxWidth="MaxWidth.ExtraExtraLarge">
                    @GetChildren()
                </MudContainer>
            </MudMainContent>
        </MudLayout>
    </Authorized>
    <NotAuthorized>
        <MudBreakpointProvider>
            <MudHidden Breakpoint="Breakpoint.SmAndUp">
                @GetChildren()
            </MudHidden>
            <MudHidden Breakpoint="Breakpoint.Xs">
                <MudOverlay DarkBackground="true" Visible="true">
                    @GetChildren()
                </MudOverlay>
            </MudHidden>
        </MudBreakpointProvider>
    </NotAuthorized>
    <Authorizing>
        Authorizing
    </Authorizing>
</PermissionAuthorizeView>
